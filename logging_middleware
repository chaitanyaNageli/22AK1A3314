import fetch from "node-fetch";

async function Log(stack, level, pkg, message) {
    const logPayload = {
        stack,
        level,
        package: pkg,
        message,
        timestamp: new Date().toISOString()
    };

    const token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJNYXBDbGFpbXMiOnsiYXVkIjoiaHR0cDovLzIwLjI0NC41Ni4xNDQvZXZhbHVhdGlvbi1zZXJ2aWNlIiwiZW1haWwiOiJjaGFpdGFueWFuYWdlbGlAZ21haWwuY29tIiwiZXhwIjoxNzU3MTUzNTAwLCJpYXQiOjE3NTcxNTI2MDAsImlzcyI6IkFmZm9yZCBNZWRpY2FsIFRlY2hub2xvZ2llcyBQcml2YXRlIExpbWl0ZWQiLCJqdGkiOiJlZWU2ZjQyZC0wZjQyLTQ0MjgtODVkYS05MzQ4YzY4YTljMzciLCJsb2NhbGUiOiJlbi1JTiIsIm5hbWUiOiJjaGFpdGFueWEga3VtYXIiLCJzdWIiOiI3NDM5MDZmZi1mZjExLTQ2ZDctYWZjZS01ZDVmNGVhMjYzNzgifSwiZW1haWwiOiJjaGFpdGFueWFuYWdlbGlAZ21haWwuY29tIiwibmFtZSI6ImNoYWl0YW55YSBrdW1hciIsInJvbGxObyI6IjIyYWsxYTMzMTQiLCJhY2Nlc3NDb2RlIjoieXpadmdHIiwiY2xpZW50SUQiOiI3NDM5MDZmZi1mZjExLTQ2ZDctYWZjZS01ZDVmNGVhMjYzNzgiLCJjbGllbnRTZWNyZXQiOiJWWnR0RXhlTnFEQXRBR25aIn0.3nIFbuBUHoAKPC6miAz3VtQlN_XRAh6HuQXKZBCIy2U" ;

    try {
        const response = await fetch("http://20.244.56.144/evaluation-service/logs", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": `Bearer ${token}`
            },
            body: JSON.stringify(logPayload)
        });

        const data = await response.json();

        console.log("Status Code:", response.status);
        console.log("Response:", data);
    } catch (error) {
        console.error("Error while sending log:", error.message);
    }
}

// Test it
Log("backend", "error", "handler", "received string expected bool");
